"use strict";(()=>{var e={};e.id=40,e.ids=[40],e.modules={1185:e=>{e.exports=require("mongoose")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4283:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>h,patchFetch:()=>f,requestAsyncStorage:()=>m,routeModule:()=>c,serverHooks:()=>y,staticGenerationAsyncStorage:()=>g});var n={};t.r(n),t.d(n,{DELETE:()=>l,GET:()=>d});var o=t(9303),i=t(8716),a=t(670),s=t(7070),u=t(6773),p=t(3785);async function d(e){try{await (0,u.u)();let{searchParams:r}=new URL(e.url),t=Math.max(1,parseInt(r.get("page")??"1",10)),n=Math.min(100,Math.max(1,parseInt(r.get("pageSize")??"20",10))),o=r.get("provider"),i=r.get("keyword"),a={};o&&["claude","openai","gemini","grok"].includes(o)&&(a.provider=o),i&&i.trim().length>0&&(a.primaryKeyword={$regex:i.trim(),$options:"i"});let[d,l]=await Promise.all([p.f.find(a).sort({createdAt:-1}).skip((t-1)*n).limit(n).lean(),p.f.countDocuments(a)]),c=d.map(e=>({id:String(e._id),provider:e.provider,primaryKeyword:e.primaryKeyword,contentSnippet:e.contentSnippet,urlCount:e.urlCount,liveUrlCount:e.liveUrlCount,h2:e.h2,h3:e.h3,paragraph1:e.paragraph1,paragraph2:e.paragraph2,metaTitle:e.metaTitle,metaDescription:e.metaDescription,internalLinks:e.internalLinks,placementRecommendation:e.placementRecommendation,tokensUsed:e.tokensUsed,durationMs:e.durationMs,createdAt:e.createdAt.toISOString()}));return s.NextResponse.json({success:!0,data:{results:c,total:l,page:t,pageSize:n}})}catch(r){console.error("[/api/results] GET error:",r);let e=r instanceof Error?r.message:"Failed to fetch results";return s.NextResponse.json({success:!1,error:e},{status:500})}}async function l(e){try{await (0,u.u)();let{searchParams:r}=new URL(e.url),t=r.get("id");if(!t||0===t.trim().length)return s.NextResponse.json({success:!1,error:'Query param "id" is required'},{status:400});if(!await p.f.findByIdAndDelete(t))return s.NextResponse.json({success:!1,error:"Record not found"},{status:404});return s.NextResponse.json({success:!0,id:t})}catch(r){console.error("[/api/results] DELETE error:",r);let e=r instanceof Error?r.message:"Failed to delete record";return s.NextResponse.json({success:!1,error:e},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/results/route",pathname:"/api/results",filename:"route",bundlePath:"app/api/results/route"},resolvedPagePath:"C:\\Projects\\House of Coco Content App\\Seocontentoptimizerapp-main\\Backend\\app\\api\\results\\route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:m,staticGenerationAsyncStorage:g,serverHooks:y}=c,h="/api/results/route";function f(){return(0,a.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:g})}},6773:(e,r,t)=>{t.d(r,{u:()=>s});var n=t(1185),o=t.n(n);let i=process.env.MONGODB_URI;if(!i)throw Error("MONGODB_URI is not defined. Add it to your .env.local file.\nExample: MONGODB_URI=mongodb+srv://<user>:<pass>@cluster.mongodb.net/seo-optimizer");let a=global._mongooseCache??{conn:null,promise:null};async function s(){if(a.conn)return a.conn;a.promise||(a.promise=o().connect(i,{bufferCommands:!1,maxPoolSize:10,serverSelectionTimeoutMS:5e3,socketTimeoutMS:45e3}));try{a.conn=await a.promise}catch(e){throw a.promise=null,e}return a.conn}global._mongooseCache=a},3785:(e,r,t)=>{t.d(r,{f:()=>s});var n=t(1185),o=t.n(n);let i=new n.Schema({anchorText:{type:String,required:!0},url:{type:String,required:!0},isLive:{type:Boolean,required:!0,default:!0}},{_id:!1}),a=new n.Schema({provider:{type:String,required:!0,enum:["claude","openai","gemini","grok"]},primaryKeyword:{type:String,required:!0,trim:!0},contentSnippet:{type:String,required:!0},urlCount:{type:Number,required:!0,min:0},liveUrlCount:{type:Number,required:!0,min:0},h2:{type:String,required:!0},h3:{type:String,required:!0},paragraph1:{type:String,required:!0},paragraph2:{type:String,required:!0},metaTitle:{type:String,required:!0,maxlength:55},metaDescription:{type:String,required:!0,maxlength:145},internalLinks:{type:[i],default:[]},placementRecommendation:{type:String,required:!0},tokensUsed:{type:Number},durationMs:{type:Number,required:!0}},{timestamps:{createdAt:!0,updatedAt:!1},collection:"generation_results"});a.index({createdAt:-1}),a.index({provider:1,createdAt:-1}),a.index({primaryKeyword:"text"});let s=o().models.GenerationResult??o().model("GenerationResult",a)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),n=r.X(0,[789],()=>t(4283));module.exports=n})();